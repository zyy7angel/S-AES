# S-AES
Implementation and exploration of S-AES encryption algorithm
***
## 第一关：基本测试
1. 加密    
   明文：`1010011101001001`,    
   密钥：`0010110101010101`;    
   密文：`1100001101001001`.        
   ![](/images/S-AES-encrypt.jpg)        
2. 解密    
   密文：`1100001101001001`;    
   密钥：`0010110101010101`;    
   明文：`1010011101001001`.
   ![](/images/S-AES-decrypt.jpg)
   ***
## 第二关：交叉测试

***
## 第三关：扩展功能
扩展要求：考虑到向实用性扩展，加密算法的数据输入可以是ASII编码字符串(分组为2 Bytes)，对应地输出也可以是ACII字符串(很可能是乱码)。         
主要通过四个扩展功能实现：    
`ascii_string_to_blocks()`    
`blocks_to_ascii_string()`    
`string_to_blocks()`    
`blocks_to_string()`    
1. ascii加密        
   明文：`Hello,World!`    
   密钥：`0010110101010101`    
   密文：`éVÍ^]bGíL¶È'M`    
   ![](/images/ascii-encrypt.jpg)        
2. ascii解密        
   密文：`éVÍ^]bGíL¶È'M`    
   密钥：`0010110101010101`        
   明文：`Hello,World!`               
   ![](/images/ascii-decrypt.jpg)            
***
## 第四关： 多重加密
1. 双重加密
   要求：将S-AES算法通过双重加密进行扩展，分组长度仍然是16 bits，但密钥长度为32 bits。
   主要实现函数：
   `double_encrypt()`    
   `double_decrypt()`    
   * 双重加密        
     明文：`0xffff`            
     密钥：`0xffff0000`                
     密文：`11010011100`    
     ![](/images/double-encrypt.jpg)        
   * 双重解密        
     密文：`11010011100`                
     密钥：`0xffff0000`                
     明文：`0xffff`    
     ![](/images/double-decrypt.jpg)        
2. 中间相遇攻击    
   要求：假设你找到了使用相同密钥的明、密文对(一个或多个)，请尝试使用中间相遇攻击的方法找到正确的     
   密钥Key(K1+K2)。        
   解决办法：`attack()`函数实现。传统的暴力破解通常需要尝试每一个可能的密钥组合（假设每个密钥的长度是$n$位，那么需要$2^n$次尝试）。通过中间相遇攻击，攻击者可以将问题拆分为两部分：每一部分的暴力搜索都只需要 $2^\\frac{n}{2}$次尝试。因此，整体时间复杂度降低到$O(2^\\frac{n}{2})$，即暴力破解的搜索空间减半。        
   明密文对：    
   `1111111111111111`
   `0000011010011100`        
   找到的密钥：        
   ![](/images/attack.jpg)    
3. 三重加密    
   要求：将S-AES算法通过三重加密进行扩展，下面两种模式选择一种完成：    
   ** (1)按照32 bits密钥Key(K1+K2)的模式进行三重加密解密，**        
   (2)使用48bits(K1+K2+K3)的模式进行三重加解密。    
   选择要求(1),实现函数`triple_encrypt()`
   `triple_decrypt()`        
   * 三重加密    
     明文：`1100110011001100`            
     密钥：`0xaaaaaaaa`                
     密文：`110100010110101`    
     ![](/images/three-encrypt.jpg)    
   * 三重解密    
     密文：`110100010110101`                
     密钥：`0xaaaaaaaa`                 
     明文：`1100110011001100`    
     ![](/images/three-decrypt.jpg)    
***
## 第五关：工作模式
要求：基于S-AES算法，使用密码分组链(CBC)模式对较长的明文消息进行加密。注意初始向量(16 bits) 的生成，并需要加解密双方共享。         
在CBC模式下进行加密，并尝试对密文分组进行替换或修改，然后进行解密，请对比篡改密文前后的解密结果。        
1. CBC加密    
   明文：`10000000000011110001110110111111`            
   密钥：`0x2d55`        
   初始向量：`0x1234`           
   密文：`11100101011011010000100010000111`        
   ![](/images/CBC-encrypt.jpg)            
3. CBC解密        
   密文：`11100101011011010000100010000111`            
   密钥：`0x2d55`          
   初始向量：`0x1234`              
   明文：`10000000000011110001110110111111`                
   ![](/images/CBC-decrypt.jpg)            






















   
